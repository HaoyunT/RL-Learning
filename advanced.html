<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>å¼ºåŒ–å­¦ä¹ è¿›é˜¶ç®—æ³• | Yun</title>
<!-- æ•°å­¦å…¬å¼æ¸²æŸ“ -->
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$', '$$'], ['\\[', '\\]']]
    }
  };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<!-- Prism.js æ ·å¼ä¸è„šæœ¬ -->
<link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-coy.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-python.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-javascript.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-bash.min.js"></script>
<link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>

<style>
body {
  margin: 0;
  font-family: "Segoe UI", "Roboto", -apple-system, sans-serif;
  background: linear-gradient(135deg, #121620 0%, #1b1f2b 40%, #221814 100%);
  color: #f5f5f5;
  line-height: 1.8;
  scroll-behavior: smooth;
}

header {
  position: sticky;
  top: 0;
  z-index: 100;
  text-align: center;
  background: rgba(20, 18, 24, 0.92);
  padding: 28px 20px 18px;
  backdrop-filter: blur(10px);
  border-bottom: 1px solid rgba(255, 140, 66, 0.35);
  box-shadow: 0 6px 22px rgba(0, 0, 0, 0.5);
}

header h1 {
  font-size: 2.3rem;
  color: #ff9740;
  margin: 0;
  font-weight: 700;
  letter-spacing: 1.5px;
}

nav ul {
  list-style: none;
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  gap: 10px;
  padding: 0;
  margin: 18px 0 0;
}

nav a {
  color: #f0dccc;
  text-decoration: none;
  font-weight: 600;
  font-size: 0.95rem;
  padding: 6px 16px;
  border-radius: 6px;
  transition: all 0.3s ease;
  background: rgba(255, 140, 66, 0.1);
  border: 1px solid rgba(255, 140, 66, 0.2);
}

nav a:hover, nav a.active {
  color: #ff9740;
  background: rgba(255, 140, 66, 0.2);
  border-color: rgba(255, 140, 66, 0.5);
  box-shadow: 0 0 14px rgba(255, 140, 66, 0.35);
}

.container {
  display: flex;
  position: relative;
  z-index: 5;
  max-width: 1400px;
  margin: 30px auto;
  gap: 30px;
  padding: 0 20px 40px;
}

aside {
  position: sticky;
  top: 130px;
  width: 260px;
  height: fit-content;
  background: rgba(28, 24, 32, 0.88);
  border: 1px solid rgba(255, 140, 66, 0.25);
  border-radius: 12px;
  padding: 22px;
  backdrop-filter: blur(12px);
  flex-shrink: 0;
}

aside h3 {
  color: #ff9740;
  font-size: 1.15rem;
  margin: 0 0 16px 0;
  padding-bottom: 10px;
  border-bottom: 2px solid rgba(255, 140, 66, 0.35);
}

aside ul {
  list-style: none;
  margin: 0;
  padding: 0;
  display: grid;
  gap: 6px;
}

aside a {
  color: #f0dccc;
  text-decoration: none;
  font-size: 0.9rem;
  padding: 8px 12px;
  border-radius: 6px;
  transition: all 0.2s ease;
  border-left: 3px solid transparent;
  background: transparent;
}

aside a:hover, aside a.active {
  color: #ff9740;
  background: rgba(255, 140, 66, 0.12);
  border-left-color: #ff9740;
  padding-left: 16px;
}

main {
  flex: 1;
  min-width: 0;
}

.chapter {
  background: rgba(28, 24, 32, 0.82);
  border: 1px solid rgba(255, 140, 66, 0.2);
  border-radius: 14px;
  padding: 36px;
  margin-bottom: 35px;
  transition: all 0.3s ease;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.45);
}

.chapter:hover {
  border-color: rgba(255, 140, 66, 0.4);
  transform: translateY(-3px);
  box-shadow: 0 16px 38px rgba(0, 0, 0, 0.55);
}

.chapter h2 {
  color: #ff8c42;
  font-size: 1.85rem;
  margin: 0 0 24px 0;
  padding-bottom: 12px;
  border-bottom: 2px solid rgba(255, 140, 66, 0.3);
  font-weight: 700;
}

.chapter h3 {
  color: #ffb061;
  font-size: 1.25rem;
  margin-top: 26px;
  border-left: 4px solid rgba(255, 176, 97, 0.6);
  padding-left: 12px;
}

.chapter p, .chapter li {
  color: #f2e6dc;
}

.chapter strong {
  color: #ffb061;
}

.chapter code {
  background: rgba(255, 140, 66, 0.15);
  color: #ffd9b3;
  padding: 3px 6px;
  border-radius: 4px;
}

table {
  width: 100%;
  border-collapse: collapse;
  margin: 18px 0;
  background: rgba(255, 140, 66, 0.06);
  border-radius: 10px;
  overflow: hidden;
  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.35);
}

table th, table td {
  padding: 12px 16px;
  border-bottom: 1px solid rgba(255, 140, 66, 0.2);
  color: #f7ede2;
}

table th {
  background: rgba(255, 140, 66, 0.22);
  color: #fff1e6;
  font-size: 1.05rem;
}

table tr:last-child td {
  border-bottom: none;
}

pre[class*="language-"] {
  background: linear-gradient(135deg, rgba(30, 24, 33, 0.92) 0%, rgba(36, 28, 36, 0.95) 100%) !important;
  border: 1px solid rgba(255, 140, 66, 0.28) !important;
  border-radius: 12px !important;
  padding: 20px !important;
  overflow-x: auto !important;
  font-size: 0.93rem !important;
  line-height: 1.62 !important;
  box-shadow: 0 12px 28px rgba(0, 0, 0, 0.55) !important;
}

pre[class*="language-"]::before {
  content: attr(class);
  position: absolute;
  top: 10px;
  right: 14px;
  font-size: 0.7rem;
  color: rgba(255, 189, 128, 0.7);
  letter-spacing: 0.6px;
  text-transform: uppercase;
}

pre.line-numbers {
  padding-left: 65px !important;
}

.line-numbers-rows {
  background: rgba(255, 140, 66, 0.1) !important;
  border-right: 2px solid rgba(255, 140, 66, 0.25) !important;
}

.line-numbers-rows > span:before {
  color: rgba(255, 189, 128, 0.7) !important;
}

footer {
  text-align: center;
  padding: 28px 20px;
  background: rgba(20, 18, 24, 0.9);
  border-top: 1px solid rgba(255, 140, 66, 0.3);
  color: #f0dccc;
  margin-top: 60px;
  font-size: 0.9rem;
}

footer span {
  color: #ff9740;
  font-weight: 600;
}

@media (max-width: 1024px) {
  .container {
    flex-direction: column;
  }
  aside {
    position: relative;
    top: auto;
    width: 100%;
  }
}

@media (max-width: 768px) {
  header h1 {
    font-size: 2rem;
  }
  nav a {
    font-size: 0.85rem;
    padding: 4px 12px;
  }
  .container {
    padding: 0 12px 30px;
  }
  .chapter {
    padding: 24px;
  }
}
</style>
</head>
<body>
<header>
  <h1>å¼ºåŒ–å­¦ä¹ ç¬”è®°ï¼ˆè¿›é˜¶ç¯‡ï¼‰</h1>
  <nav>
    <ul>
      <li><a href="index.html">é¦–é¡µ</a></li>
      <li><a href="home.html">åŸºç¡€ç¬”è®°</a></li>
      <li><a href="#chapter14">Dueling DQN</a></li>
      <li><a href="#chapter15">PER</a></li>
      <li><a href="#chapter16">NoisyNet</a></li>
      <li><a href="#chapter17">Rainbow</a></li>
  <li><a href="#chapter18">DDPG</a></li>
  <li><a href="#chapter19">TD3</a></li>
  <li><a href="#chapter20">TRPO</a></li>
  <li><a href="#chapter21">PPO</a></li>
  <li><a href="#chapter22">SAC</a></li>
  <li><a href="#chapter23">ç»„åˆç­–ç•¥</a></li>
  <li><a href="#chapter_summary">è¿›é˜¶æ€»ç»“</a></li>
    </ul>
  </nav>
</header>

<div class="container">
  <aside>
    <h3>ğŸ”¥ è¿›é˜¶ç›®å½•</h3>
    <ul>
      <li><a href="#chapter14">ç¬¬åå››ç« ï¼šDueling DQN</a></li>
      <li><a href="#chapter15">ç¬¬åäº”ç« ï¼šPER</a></li>
      <li><a href="#chapter16">ç¬¬åå…­ç« ï¼šNoisyNet DQN</a></li>
      <li><a href="#chapter17">ç¬¬åä¸ƒç« ï¼šRainbow DQN</a></li>
      <li><a href="#chapter18">ç¬¬åå…«ç« ï¼šDDPG</a></li>
      <li><a href="#chapter19">ç¬¬åä¹ç« ï¼šTD3</a></li>
      <li><a href="#chapter20">ç¬¬äºŒåç« ï¼šTRPO</a></li>
      <li><a href="#chapter21">ç¬¬äºŒåä¸€ç« ï¼šPPO</a></li>
      <li><a href="#chapter22">ç¬¬äºŒåäºŒç« ï¼šSAC</a></li>
      <li><a href="#chapter23">ç¬¬äºŒåä¸‰ç« ï¼šç­–ç•¥æ¢¯åº¦å¢å¼ºç»„åˆ</a></li>
      <li><a href="#chapter_summary">è¿›é˜¶æ€»ç»“</a></li>
    </ul>
  </aside>

  <main>
    <section id="chapter14" class="chapter">
      <h2>ç¬¬åå››ç« ï¼šDueling DQNï¼ˆåŒæµæ¶æ„ï¼‰</h2>
      <p>Dueling DQN å°† Q ç½‘ç»œæ‹†åˆ†ä¸º<strong>çŠ¶æ€ä»·å€¼åˆ†æ”¯ V(s)</strong>ä¸<strong>åŠ¨ä½œä¼˜åŠ¿åˆ†æ”¯ A(s,a)</strong>ï¼Œé€šè¿‡ä¸åŒçš„å­ç½‘ç»œæ•è·â€œå½“å‰çŠ¶æ€æœ¬èº«å¥½ä¸å¥½â€ä»¥åŠâ€œåœ¨è¯¥çŠ¶æ€ä¸‹æ¯ä¸ªåŠ¨ä½œç›¸å¯¹ä¼˜åŠ¿å¦‚ä½•â€ã€‚</p>

      <h3>1. æ ¸å¿ƒç»“æ„</h3>
      <p>åŒæµæ¶æ„åœ¨å·ç§¯æˆ–å‰é¦ˆä¸»å¹²ä¹‹ååˆ†æˆä¸¤æ¡åˆ†æ”¯ï¼š</p>
      <ul>
        <li><strong>Value Streamï¼š</strong>$V(s)$ è¡¨ç¤ºçŠ¶æ€æœ¬èº«çš„ä»·å€¼ï¼›</li>
        <li><strong>Advantage Streamï¼š</strong>$A(s,a)$ è¡¨ç¤ºç»™å®šçŠ¶æ€ä¸‹é‡‡å–åŠ¨ä½œ $a$ çš„é¢å¤–æ”¶ç›Šã€‚</li>
      </ul>
      <p>æœ€ç»ˆçš„ Q å€¼é€šè¿‡ä¸‹å¼é‡ç»„ï¼š</p>
      <p>$$
      Q(s, a) = V(s) + \Big(A(s, a) - \frac{1}{|\mathcal{A}|} \sum_{a'} A(s, a')\Big)
      $$</p>
      <p>å‡å»ä¼˜åŠ¿çš„å‡å€¼æ˜¯ä¸ºäº†ä¿è¯ <code>A</code> çš„å¯è¾¨è¯†æ€§ï¼Œä½¿å¾— $\sum_a A(s,a)=0$ã€‚</p>

      <h3>2. å…³é”®æ”¶ç›Š</h3>
      <ul>
        <li>åœ¨æŸäº›çŠ¶æ€åŠ¨ä½œå·®å¼‚ä¸å¤§æ—¶ï¼Œå•ç‹¬ä¼°è®¡ V(s) æ›´ç¨³å®šï¼›</li>
        <li>ä¼˜åŠ¿åˆ†æ”¯ä¾§é‡å­¦ä¹ åŠ¨ä½œå·®å¼‚ï¼Œå¢å¼ºä¼°å€¼çµæ•åº¦ï¼›</li>
        <li>ä¸ Double/Double Dueling æ¶æ„ç»„åˆå¸¸æ˜¾è‘—æå‡ Atari è¡¨ç°ã€‚</li>
      </ul>

      <h3>3. ä»£ç éª¨æ¶</h3>
<pre class="language-python line-numbers"><code>import torch
import torch.nn as nn

class DuelingNetwork(nn.Module):
    def __init__(self, state_dim, action_dim):
        super().__init__()
        self.shared = nn.Sequential(
            nn.Linear(state_dim, 256),
            nn.ReLU(),
            nn.Linear(256, 256),
            nn.ReLU(),
        )
        self.value_stream = nn.Sequential(
            nn.Linear(256, 128),
            nn.ReLU(),
            nn.Linear(128, 1),
        )
        self.advantage_stream = nn.Sequential(
            nn.Linear(256, 128),
            nn.ReLU(),
            nn.Linear(128, action_dim),
        )

    def forward(self, x):
        feat = self.shared(x)
        value = self.value_stream(feat)
        advantage = self.advantage_stream(feat)
        advantage = advantage - advantage.mean(dim=1, keepdim=True)
        return value + advantage</code></pre>
    </section>

    <section id="chapter15" class="chapter">
      <h2>ç¬¬åäº”ç« ï¼šPrioritized Experience Replayï¼ˆPERï¼‰</h2>
      <p>Prioritized Experience Replay æ ¹æ® TD è¯¯å·®å¤§å°å†³å®šæ ·æœ¬è¢«é‡‡æ ·çš„æ¦‚ç‡ï¼Œè®©å­¦ä¹ é›†ä¸­äºæ„å¤–ç¨‹åº¦é«˜ã€æå‡ç©ºé—´å¤§çš„ç‰‡æ®µã€‚</p>

      <h3>1. é‡‡æ ·æ¦‚ç‡å®šä¹‰</h3>
      <p>ç»éªŒç‰‡æ®µ $i$ çš„é‡‡æ ·æ¦‚ç‡å®šä¹‰ä¸ºï¼š</p>
      <p>$$
      P(i) = \frac{p_i^\alpha}{\sum_k p_k^\alpha}, \quad p_i = |\delta_i| + \varepsilon
      $$</p>
      <ul>
        <li>$\delta_i$ï¼šæ ·æœ¬ TD è¯¯å·®</li>
        <li>$\alpha$ï¼šæ§åˆ¶ä¼˜å…ˆé‡‡æ ·ç¨‹åº¦ï¼ˆ0 è¡¨ç¤ºå‡åŒ€é‡‡æ ·ï¼‰</li>
        <li>$\varepsilon$ï¼šé¿å… 0 æ¦‚ç‡çš„å¸¸æ•°</li>
      </ul>

      <h3>2. é‡è¦æ€§é‡‡æ ·æƒé‡</h3>
      <p>ä¸ºæŠµæ¶ˆåå·®ï¼Œå¼•å…¥é‡è¦æ€§é‡‡æ ·æƒé‡ï¼š</p>
      <p>$$
      w_i = \Big(\frac{1}{N \cdot P(i)}\Big)^\beta, \quad \beta \nearrow 1
      $$</p>
      <p>$\beta$ ä»è¾ƒå°å€¼é€’å¢ï¼Œä»¥é€æ­¥æ ¡æ­£åˆ†å¸ƒåå·®ã€‚</p>

      <h3>3. Sum-Tree å®ç°è¦ç‚¹</h3>
      <ul>
        <li>ç”¨äºŒå‰æ ‘ç»´æŠ¤ä¼˜å…ˆçº§å‰ç¼€å’Œï¼Œé‡‡æ ·å’Œæ›´æ–°å¤æ‚åº¦é™ä¸º $O(\log N)$ï¼›</li>
        <li>æ¯æ¬¡é‡‡æ ·ä½¿ç”¨éšæœºé˜ˆå€¼ $u \in [0, \text{total})$ åœ¨æ ‘ä¸­æŸ¥æ‰¾å¯¹åº”å¶å­ï¼›</li>
        <li>æ›´æ–° TD è¯¯å·®åéœ€å›å†™æ ‘èŠ‚ç‚¹ã€‚</li>
      </ul>
    </section>

    <section id="chapter16" class="chapter">
      <h2>ç¬¬åå…­ç« ï¼šNoisyNet DQN</h2>
      <p>NoisyNet é€šè¿‡åœ¨ç½‘ç»œå‚æ•°ä¸­å¼•å…¥å™ªå£°ï¼Œæ›¿ä»£ä¼ ç»Ÿçš„ $\varepsilon$-greedy ç­–ç•¥ï¼Œå®ç°å¯å­¦ä¹ çš„æ¢ç´¢ç¨‹åº¦ã€‚</p>

      <h3>1. å™ªå£°çº¿æ€§å±‚</h3>
      <p>ä½¿ç”¨å‚æ•°åŒ–å™ªå£°ï¼š</p>
      <p>$$
      y = (\mu_w + \sigma_w \odot \varepsilon_w) x + (\mu_b + \sigma_b \odot \varepsilon_b)
      $$</p>
      <ul>
        <li>$\mu$ã€$\sigma$ï¼šå¯è®­ç»ƒå‚æ•°</li>
        <li>$\varepsilon$ï¼šæ¯æ¬¡å‰å‘ä¼ æ’­é‡‡æ ·å™ªå£°</li>
      </ul>

      <h3>2. æ¢ç´¢ä¼˜åŠ¿</h3>
      <ul>
        <li>å™ªå£°å¤§å°å¯è¢«å­¦ä¹ è°ƒæ•´ï¼Œæ¢ç´¢åº¦éšè®­ç»ƒè‡ªåŠ¨å˜åŒ–ï¼›</li>
        <li>å¯¹é•¿æœŸä»»åŠ¡æ¯”å›ºå®š $\varepsilon$ æ›´çµæ´»ï¼›</li>
        <li>é€‚åˆä¸ Duelingã€PER ç­‰ç»„åˆã€‚</li>
      </ul>
    </section>

    <section id="chapter17" class="chapter">
      <h2>ç¬¬åä¸ƒç« ï¼šRainbow DQN</h2>
      <p>Rainbow å°†å…­å¤§æ”¹è¿›æ•´åˆè¿›å•ä¸€æ¡†æ¶ï¼Œåœ¨ Atari æ¸¸æˆä¸­è¾¾åˆ°æ˜¾è‘—æ€§èƒ½çªç ´ï¼š</p>
      <ol>
        <li>Dueling æ¶æ„</li>
        <li>Double DQN</li>
        <li>Prioritized Replay</li>
        <li>NoisyNet æ¢ç´¢</li>
        <li>Multi-step Returns</li>
        <li>åˆ†å¸ƒå¼å€¼å‡½æ•°ï¼ˆC51ï¼‰</li>
      </ol>

      <h3>1. Multi-step Target</h3>
      <p>é‡‡ç”¨ $n$ æ­¥å›æŠ¥ï¼š</p>
      <p>$$
      G_t^{(n)} = \sum_{k=0}^{n-1} \gamma^k r_{t+k} + \gamma^n V(s_{t+n})
      $$</p>

      <h3>2. åˆ†å¸ƒå¼ Q å‡½æ•°</h3>
      <p>Rainbow è¾“å‡ºçš„æ˜¯ä»·å€¼åˆ†å¸ƒ $Z(s,a)$ï¼Œå¹¶ä½¿ç”¨ KL æ•£åº¦æŸå¤±æŠ•å½±åˆ°æ”¯æŒé›†åˆä¸Šã€‚</p>
    </section>

    <section id="chapter18" class="chapter">
      <h2>ç¬¬åå…«ç« ï¼šDDPGï¼ˆDeep Deterministic Policy Gradientï¼‰</h2>
      <p>DDPG å°† Actor-Critic å¼•å…¥è¿ç»­åŠ¨ä½œç©ºé—´ï¼Œé‡‡ç”¨ç¡®å®šæ€§ç­–ç•¥ $\mu_\theta(s)$ ä¸ Q ç½‘ç»œ $Q_w(s,a)$ äº’ç›¸æ›´æ–°ã€‚</p>

      <h3>1. ç­–ç•¥ä¸ Q æ›´æ–°</h3>
      <p>Critic ç›®æ ‡ï¼š</p>
      <p>$$
      y_t = r_t + \gamma Q_w'(s_{t+1}, \mu_{\theta'}(s_{t+1}))
      $$</p>
      <p>Actor æ¢¯åº¦ï¼š</p>
      <p>$$
      \nabla_\theta J \approx \frac{1}{N} \sum_i \nabla_a Q_w(s_i,a)\big|_{a=\mu_\theta(s_i)} \nabla_\theta \mu_\theta(s_i)
      $$</p>

      <h3>2. å…³é”®æŠ€å·§</h3>
      <ul>
        <li>ç›®æ ‡ç½‘ç»œè½¯æ›´æ–°ï¼š$\theta' \leftarrow \tau\theta + (1-\tau)\theta'$ï¼›</li>
        <li>Ornstein-Uhlenbeck å™ªå£°é€‚åº”è¿ç»­åŠ¨ä½œæ¢ç´¢ï¼›</li>
        <li>å¯¹è¾“å…¥ç‰¹å¾åšå½’ä¸€åŒ–æå‡ç¨³å®šæ€§ã€‚</li>
      </ul>
    </section>

    <section id="chapter19" class="chapter">
      <h2>ç¬¬åä¹ç« ï¼šTD3ï¼ˆTwin Delayed DDPGï¼‰</h2>
      <p>TD3 é’ˆå¯¹ DDPG è¿‡ä¼°è®¡å’Œè®­ç»ƒä¸ç¨³å®šé—®é¢˜æå‡ºä¸‰é¡¹æ”¹è¿›ï¼š</p>
      <ol>
        <li><strong>åŒ Criticï¼š</strong>å–ä¸¤ä¸ª Q ç½‘ç»œçš„è¾ƒå°å€¼ä½œä¸ºç›®æ ‡ï¼ŒæŠ‘åˆ¶è¿‡ä¼°è®¡ï¼›</li>
        <li><strong>å»¶è¿Ÿç­–ç•¥æ›´æ–°ï¼š</strong>å¤šæ¬¡ Critic æ›´æ–°åå†æ›´æ–° Actorï¼›</li>
        <li><strong>ç›®æ ‡å¹³æ»‘ï¼š</strong>åœ¨ç›®æ ‡åŠ¨ä½œä¸Šæ·»åŠ å°å™ªå£°ï¼Œç¼“è§£è¯¯å·®æ”¾å¤§ã€‚</li>
      </ol>

      <h3>1. ç›®æ ‡è®¡ç®—</h3>
      <p>$$
      y_t = r_t + \gamma \min_{i=1,2} Q_{w_i}'(s_{t+1}, \tilde{a}), \quad \tilde{a} = \mu_{\theta'}(s_{t+1}) + \epsilon,\ \epsilon \sim \mathcal{N}(0, \sigma)
      $$</p>

      <h3>2. å®è·µå»ºè®®</h3>
      <ul>
        <li>Critic:Actor æ›´æ–°é¢‘ç‡é€šå¸¸ 2:1ï¼›</li>
        <li>ç›®æ ‡å™ªå£°è£å‰ªåœ¨ $[-c, c]$ ä¹‹é—´ï¼›</li>
        <li>ç»“åˆ layer normalization æå‡é²æ£’æ€§ã€‚</li>
      </ul>
    </section>

    <section id="chapter20" class="chapter">
      <h2>ç¬¬äºŒåç« ï¼šTRPOï¼ˆTrust Region Policy Optimizationï¼‰</h2>
      <p>TRPO åœ¨ç­–ç•¥æ¢¯åº¦ä¸­å¼•å…¥ä¿¡èµ–åŸŸçº¦æŸï¼Œé€šè¿‡æ§åˆ¶ç­–ç•¥å˜åŠ¨å¹…åº¦ä¿éšœæ€§èƒ½å•è°ƒæå‡ã€‚</p>

      <h3>1. ä¼˜åŒ–ç›®æ ‡</h3>
      <p>æœ€å¤§åŒ– surrogate objectiveï¼š</p>
      <p>$$
      L(\theta) = \mathbb{E}_{s,a \sim \pi_{\theta_{old}}} \Big[ \frac{\pi_\theta(a|s)}{\pi_{\theta_{old}}(a|s)} A_{\pi_{\theta_{old}}}(s,a) \Big]
      $$</p>
      <p>çº¦æŸ KL æ•£åº¦ä¸è¶…è¿‡é˜ˆå€¼ï¼š</p>
      <p>$$
      \mathbb{E}_{s \sim \pi_{\theta_{old}}}\big[\text{KL}(\pi_{\theta_{old}}(\cdot|s) \| \pi_\theta(\cdot|s))\big] \leq \delta
      $$</p>

      <h3>2. å…±è½­æ¢¯åº¦æ±‚è§£</h3>
      <p>é€šè¿‡å…±è½­æ¢¯åº¦è¿‘ä¼¼ Fisher ä¿¡æ¯çŸ©é˜µé€†ï¼Œç»“åˆçº¿æ€§æœç´¢æ‰¾åˆ°æ»¡è¶³ KL çº¦æŸçš„æ›´æ–°æ­¥é•¿ã€‚</p>

      <h3>3. å±€é™ä¸å»¶ä¼¸</h3>
      <ul>
        <li>æ±‚è§£å¤æ‚ï¼Œè®¡ç®—ä»£ä»·é«˜ï¼›</li>
        <li>PPO å¯çœ‹ä½œç®€åŒ–ç‰ˆï¼Œä¿ç•™æ ¸å¿ƒæ€æƒ³åŒæ—¶æå‡æ˜“ç”¨æ€§ã€‚</li>
      </ul>
    </section>

    <section id="chapter21" class="chapter">
      <h2>ç¬¬äºŒåä¸€ç« ï¼šPPOï¼ˆProximal Policy Optimizationï¼‰</h2>
      <p>PPO ä½¿ç”¨å‰ªåˆ‡ç­–ç•¥æŸå¤±ï¼Œåœ¨ä¿æŒ KL çº¦æŸæ€æƒ³çš„åŒæ—¶é‡‡å–å¯å¾®åˆ†çš„ç®€å•ç›®æ ‡å‡½æ•°ï¼Œæ˜¯å·¥ä¸šå’Œç ”ç©¶ä¸­çš„ä¸»æµé€‰æ‹©ã€‚</p>

      <h3>1. Clipped Loss</h3>
      <p>$$
      L^{CLIP}(\theta) = \mathbb{E}\big[\min(r_t(\theta) A_t, \text{clip}(r_t(\theta), 1-\epsilon, 1+\epsilon) A_t)\big]
      $$</p>
      <p>å…¶ä¸­ $r_t(\theta) = \frac{\pi_\theta(a_t|s_t)}{\pi_{\theta_{old}}(a_t|s_t)}$ã€‚</p>

      <h3>2. å®è·µè¦ç‚¹</h3>
      <ul>
        <li>ä¼˜åŠ¿ä¼°è®¡å¸¸ç”¨ GAEï¼›</li>
        <li>å¤šè½® epoch å¯¹åŒä¸€æ‰¹æ¬¡æ ·æœ¬ä¼˜åŒ–ï¼›</li>
        <li>é…åˆ value loss ä¸ entropy bonusã€‚</li>
      </ul>

      <h3>3. ä»£ç æ¡†æ¶</h3>
<pre class="language-python line-numbers"><code>ratio = (new_log_prob - old_log_prob).exp()
clip_ratio = torch.clamp(ratio, 1 - eps_clip, 1 + eps_clip)
policy_loss = -torch.min(ratio * advantages, clip_ratio * advantages).mean()
value_loss = 0.5 * (returns - value_pred).pow(2).mean()
entropy_bonus = -entropy_coeff * dist.entropy().mean()
loss = policy_loss + value_loss + entropy_bonus</code></pre>
    </section>

    <section id="chapter22" class="chapter">
      <h2>ç¬¬äºŒåäºŒç« ï¼šSACï¼ˆSoft Actor-Criticï¼‰</h2>
      <p>SAC å°†æœ€å¤§ç†µå¼ºåŒ–å­¦ä¹ æ€æƒ³ä¸ Actor-Critic ç»“åˆï¼Œé¼“åŠ±ç­–ç•¥ä¿æŒé«˜ç†µï¼Œä»è€Œå…¼é¡¾æ¢ç´¢ä¸æ€§èƒ½ã€‚</p>

      <h3>1. æœ€å¤§ç†µç›®æ ‡</h3>
      <p>$$
      J(\pi) = \sum_t \mathbb{E}_{(s_t,a_t) \sim \pi}[r(s_t,a_t) + \alpha \mathcal{H}(\pi(\cdot|s_t))]
      $$</p>

      <h3>2. åŒ Q + æ¸©åº¦è‡ªé€‚åº”</h3>
      <ul>
        <li>åŒ Q ç½‘ç»œå‡è½»è¿‡ä¼°è®¡ï¼›</li>
        <li>è‡ªåŠ¨è°ƒèŠ‚æ¸©åº¦ $\alpha$ï¼Œä¿æŒç­–ç•¥ç†µæ¥è¿‘ç›®æ ‡å€¼ã€‚</li>
      </ul>

      <h3>3. æ›´æ–°æ­¥éª¤</h3>
      <ol>
        <li>æ›´æ–° Criticï¼šæœ€å°åŒ– $\frac{1}{2}(Q - y)^2$ï¼›</li>
        <li>æ›´æ–° Actorï¼šæœ€å°åŒ– $\mathbb{E}[\alpha \log \pi(a|s) - Q(s,a)]$ï¼›</li>
        <li>æ›´æ–°æ¸©åº¦ï¼šæœ€å°åŒ– $\mathbb{E}[-\alpha (\log \pi(a|s) + \mathcal{H}_{target})]$ã€‚</li>
      </ol>
    </section>

    <section id="chapter23" class="chapter">
      <h2>ç¬¬äºŒåä¸‰ç« ï¼šç­–ç•¥æ¢¯åº¦å¢å¼ºç»„åˆ</h2>
      <p>ç°ä»£å¼ºåŒ–å­¦ä¹ å¸¸å°†ä¸Šè¿°æŠ€å·§ç»„åˆä½¿ç”¨ï¼Œä»¥è·å¾—æœ€ä½³ç¨³å®šæ€§ä¸æ ·æœ¬æ•ˆç‡ï¼š</p>
      <ul>
        <li><strong>PPO + GAE + Value Clippingï¼š</strong>æˆä¸ºæ ‡å‡†åŸºçº¿ï¼›</li>
        <li><strong>SAC + HERï¼š</strong>åœ¨ç¨€ç–å¥–åŠ±ä»»åŠ¡ä¸­è¡¨ç°å‡ºè‰²ï¼›</li>
        <li><strong>TD3 + PERï¼š</strong>åœ¨è¿ç»­æ§åˆ¶ä¸­åŠ é€Ÿæ”¶æ•›ï¼›</li>
        <li><strong>Rainbow + NoisyNetï¼š</strong>å¼ºåŒ–ç¦»æ•£ä»»åŠ¡æ€§èƒ½ã€‚</li>
      </ul>

      <h3>1. ç»„åˆç­–ç•¥å¯¹æ¯”</h3>
      <table>
        <tr><th>ç»„åˆ</th><th>ç‰¹ç‚¹</th><th>å…¸å‹åœºæ™¯</th></tr>
        <tr><td>PPO + GAE</td><td>ç¨³å®šã€ä½æ–¹å·®</td><td>æœºå™¨äººã€æœ¬ä½“ä»¿çœŸ</td></tr>
        <tr><td>SAC + è‡ªé€‚åº”æ¸©åº¦</td><td>æ¢ç´¢å……åˆ†ã€é²æ£’</td><td>å¤æ‚è¿ç»­æ§åˆ¶</td></tr>
        <tr><td>TD3 + PER</td><td>åˆ©ç”¨å…³é”®æ ·æœ¬</td><td>é«˜ç»´æœºæ¢°è‡‚</td></tr>
        <tr><td>Rainbow æ•´åˆ</td><td>ç¦»æ•£ä»»åŠ¡ SOTA</td><td>Atariã€ç­–ç•¥æ¸¸æˆ</td></tr>
      </table>
    </section>

    <section id="chapter_summary" class="chapter">
      <h2>è¿›é˜¶æ€»ç»“ä¸å­¦ä¹ å»ºè®®</h2>
      <h3>1. èƒ½åŠ›åœ°å›¾</h3>
      <table>
        <tr><th>èƒ½åŠ›</th><th>ç›¸å…³ç®—æ³•</th><th>æå‡è·¯å¾„</th></tr>
        <tr><td>æ ·æœ¬æ•ˆç‡</td><td>PERã€Rainbowã€SAC</td><td>ä¼˜å…ˆé‡‡æ · â†’ å¤šæ­¥ç›®æ ‡ â†’ æœ€å¤§ç†µ</td></tr>
        <tr><td>ç¨³å®šæ€§</td><td>Duelingã€TD3ã€PPO</td><td>æ¶æ„æ”¹è¿› â†’ åŒç½‘ç»œ â†’ å‰ªåˆ‡æŸå¤±</td></tr>
        <tr><td>è¿ç»­æ§åˆ¶</td><td>DDPGã€TD3ã€SAC</td><td>ç¡®å®šæ€§ç­–ç•¥ â†’ åŒ Critic â†’ æ¸©åº¦è‡ªé€‚åº”</td></tr>
      </table>

      <h3>2. å®æˆ˜è·¯çº¿</h3>
      <ol>
        <li>å…ˆåœ¨ <code>MuJoCo</code> ç­‰ç»å…¸ç¯å¢ƒå¤ç° PPO/SACï¼›</li>
        <li>å¼•å…¥ TD3 æˆ– Rainbow å¯¹æ¯”æŒ‡æ ‡ï¼›</li>
        <li>åœ¨è‡ªå®šä¹‰ç¯å¢ƒä¸­è°ƒå‚ï¼Œè§‚å¯Ÿå™ªå£°ã€ç†µç›®æ ‡ã€å­¦ä¹ ç‡å½±å“ã€‚</li>
      </ol>

      <h3>3. æ¨èé˜…è¯»</h3>
      <ul>
        <li>"Rainbow: Combining Improvements in Deep Reinforcement Learning"</li>
        <li>"Continuous Control with Deep Reinforcement Learning" (DDPG)</li>
        <li>"Addressing Function Approximation Error in Actor-Critic Methods" (TD3)</li>
        <li>"Proximal Policy Optimization Algorithms" (PPO)</li>
        <li>"Soft Actor-Critic" ç³»åˆ—è®ºæ–‡</li>
      </ul>
    </section>
  </main>
</div>

<footer>
  <p>Â© 2025 <span>Haoyun Tang</span> | Reinforcement Learning Advanced Notes</p>
</footer>

<script>
document.addEventListener('DOMContentLoaded', () => {
  document.querySelectorAll('pre[class*="language-"]').forEach(pre => {
    if (!pre.classList.contains('line-numbers')) {
      pre.classList.add('line-numbers');
    }
  });
  if (window.Prism) {
    Prism.highlightAll();
  }
});

window.addEventListener('load', () => {
  if (window.Prism) {
    Prism.highlightAll();
  }
});

const navLinks = document.querySelectorAll('nav a');
const asideLinks = document.querySelectorAll('aside a');
const combined = [...navLinks, ...asideLinks];

window.addEventListener('scroll', () => {
  const offset = window.scrollY + 160;
  combined.forEach(link => {
    const section = document.querySelector(link.getAttribute('href'));
    if (!section) return;
    if (section.offsetTop <= offset && section.offsetTop + section.offsetHeight > offset) {
      link.classList.add('active');
    } else {
      link.classList.remove('active');
    }
  });
});
</script>
</body>
</html>