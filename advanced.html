<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>å¼ºåŒ–å­¦ä¹ è¿›é˜¶ç®—æ³• | Yun</title>
<!-- æ•°å­¦å…¬å¼æ¸²æŸ“ -->
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$', '$$'], ['\\[', '\\]']]
    }
  };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<!-- Prism.js æ ·å¼ä¸è„šæœ¬ -->
<link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-coy.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-python.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-javascript.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-bash.min.js"></script>
<link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>

<style>
body {
  margin: 0;
  font-family: "Segoe UI", "Roboto", -apple-system, sans-serif;
  background: linear-gradient(135deg, #121620 0%, #1b1f2b 40%, #221814 100%);
  color: #f5f5f5;
  line-height: 1.8;
  scroll-behavior: smooth;
}

header {
  position: sticky;
  top: 0;
  z-index: 100;
  text-align: center;
  background: rgba(20, 18, 24, 0.92);
  padding: 28px 20px 18px;
  backdrop-filter: blur(10px);
  border-bottom: 1px solid rgba(255, 140, 66, 0.35);
  box-shadow: 0 6px 22px rgba(0, 0, 0, 0.5);
}

header h1 {
  font-size: 2.3rem;
  color: #ff9740;
  margin: 0;
  font-weight: 700;
  letter-spacing: 1.5px;
}

nav ul {
  list-style: none;
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  gap: 10px;
  padding: 0;
  margin: 18px 0 0;
}

nav a {
  color: #f0dccc;
  text-decoration: none;
  font-weight: 600;
  font-size: 0.95rem;
  padding: 6px 16px;
  border-radius: 6px;
  transition: all 0.3s ease;
  background: rgba(255, 140, 66, 0.1);
  border: 1px solid rgba(255, 140, 66, 0.2);
}

nav a:hover, nav a.active {
  color: #ff9740;
  background: rgba(255, 140, 66, 0.2);
  border-color: rgba(255, 140, 66, 0.5);
  box-shadow: 0 0 14px rgba(255, 140, 66, 0.35);
}

.container {
  display: flex;
  position: relative;
  z-index: 5;
  max-width: 1400px;
  margin: 30px auto;
  gap: 30px;
  padding: 0 20px 40px;
}

aside {
  position: sticky;
  top: 130px;
  width: 260px;
  height: fit-content;
  background: rgba(28, 24, 32, 0.88);
  border: 1px solid rgba(255, 140, 66, 0.25);
  border-radius: 12px;
  padding: 22px;
  backdrop-filter: blur(12px);
  flex-shrink: 0;
}

aside h3 {
  color: #ff9740;
  font-size: 1.15rem;
  margin: 0 0 16px 0;
  padding-bottom: 10px;
  border-bottom: 2px solid rgba(255, 140, 66, 0.35);
}

aside ul {
  list-style: none;
  margin: 0;
  padding: 0;
  display: grid;
  gap: 6px;
}

aside a {
  color: #f0dccc;
  text-decoration: none;
  font-size: 0.9rem;
  padding: 8px 12px;
  border-radius: 6px;
  transition: all 0.2s ease;
  border-left: 3px solid transparent;
  background: transparent;
}

aside a:hover, aside a.active {
  color: #ff9740;
  background: rgba(255, 140, 66, 0.12);
  border-left-color: #ff9740;
  padding-left: 16px;
}

main {
  flex: 1;
  min-width: 0;
}

.chapter {
  background: rgba(28, 24, 32, 0.82);
  border: 1px solid rgba(255, 140, 66, 0.2);
  border-radius: 14px;
  padding: 36px;
  margin-bottom: 35px;
  transition: all 0.3s ease;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.45);
}

.chapter:hover {
  border-color: rgba(255, 140, 66, 0.4);
  transform: translateY(-3px);
  box-shadow: 0 16px 38px rgba(0, 0, 0, 0.55);
}

.chapter h2 {
  color: #ff8c42;
  font-size: 1.85rem;
  margin: 0 0 24px 0;
  padding-bottom: 12px;
  border-bottom: 2px solid rgba(255, 140, 66, 0.3);
  font-weight: 700;
}

.chapter h3 {
  color: #ffb061;
  font-size: 1.25rem;
  margin-top: 26px;
  border-left: 4px solid rgba(255, 176, 97, 0.6);
  padding-left: 12px;
}

.chapter p, .chapter li {
  color: #f2e6dc;
}

.chapter strong {
  color: #ffb061;
}

.chapter code {
  background: rgba(255, 140, 66, 0.15);
  color: #ffd9b3;
  padding: 3px 6px;
  border-radius: 4px;
}

table {
  width: 100%;
  border-collapse: collapse;
  margin: 18px 0;
  background: rgba(255, 140, 66, 0.06);
  border-radius: 10px;
  overflow: hidden;
  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.35);
}

table th, table td {
  padding: 12px 16px;
  border-bottom: 1px solid rgba(255, 140, 66, 0.2);
  color: #f7ede2;
}

table th {
  background: rgba(255, 140, 66, 0.22);
  color: #fff1e6;
  font-size: 1.05rem;
}

table tr:last-child td {
  border-bottom: none;
}

pre[class*="language-"] {
  background: linear-gradient(135deg, rgba(30, 24, 33, 0.92) 0%, rgba(36, 28, 36, 0.95) 100%) !important;
  border: 1px solid rgba(255, 140, 66, 0.28) !important;
  border-radius: 12px !important;
  padding: 20px !important;
  overflow-x: auto !important;
  font-size: 0.93rem !important;
  line-height: 1.62 !important;
  box-shadow: 0 12px 28px rgba(0, 0, 0, 0.55) !important;
}

pre[class*="language-"]::before {
  content: attr(class);
  position: absolute;
  top: 10px;
  right: 14px;
  font-size: 0.7rem;
  color: rgba(255, 189, 128, 0.7);
  letter-spacing: 0.6px;
  text-transform: uppercase;
}

pre.line-numbers {
  padding-left: 65px !important;
}

.line-numbers-rows {
  background: rgba(255, 140, 66, 0.1) !important;
  border-right: 2px solid rgba(255, 140, 66, 0.25) !important;
}

.line-numbers-rows > span:before {
  color: rgba(255, 189, 128, 0.7) !important;
}

footer {
  text-align: center;
  padding: 28px 20px;
  background: rgba(20, 18, 24, 0.9);
  border-top: 1px solid rgba(255, 140, 66, 0.3);
  color: #f0dccc;
  margin-top: 60px;
  font-size: 0.9rem;
}

footer span {
  color: #ff9740;
  font-weight: 600;
}

@media (max-width: 1024px) {
  .container {
    flex-direction: column;
  }
  aside {
    position: relative;
    top: auto;
    width: 100%;
  }
}

@media (max-width: 768px) {
  header h1 {
    font-size: 2rem;
  }
  nav a {
    font-size: 0.85rem;
    padding: 4px 12px;
  }
  .container {
    padding: 0 12px 30px;
  }
  .chapter {
    padding: 24px;
  }
}
</style>
</head>
<body>
<header>
  <h1>å¼ºåŒ–å­¦ä¹ ç¬”è®°ï¼ˆè¿›é˜¶ç¯‡ï¼‰</h1>
  <nav>
    <ul>
      <li><a href="index.html">é¦–é¡µ</a></li>
      <li><a href="home.html">åŸºç¡€ç¬”è®°</a></li>
      <li><a href="#chapter14">Dueling DQN</a></li>
      <li><a href="#chapter15">PER</a></li>
      <li><a href="#chapter16">NoisyNet</a></li>
      <li><a href="#chapter17">Rainbow</a></li>
  <li><a href="#chapter18">DDPG</a></li>
  <li><a href="#chapter19">TD3</a></li>
  <li><a href="#chapter20">TRPO</a></li>
  <li><a href="#chapter21">PPO</a></li>
  <li><a href="#chapter22">SAC</a></li>
  <li><a href="#chapter23">ç»„åˆç­–ç•¥</a></li>
  <li><a href="#chapter_summary">è¿›é˜¶æ€»ç»“</a></li>
    </ul>
  </nav>
</header>

<div class="container">
  <aside>
    <h3>ğŸ”¥ è¿›é˜¶ç›®å½•</h3>
    <ul>
      <li><a href="#chapter14">ç¬¬åå››ç« ï¼šDueling DQN</a></li>
      <li><a href="#chapter15">ç¬¬åäº”ç« ï¼šPER</a></li>
      <li><a href="#chapter16">ç¬¬åå…­ç« ï¼šNoisyNet DQN</a></li>
      <li><a href="#chapter17">ç¬¬åä¸ƒç« ï¼šRainbow DQN</a></li>
      <li><a href="#chapter18">ç¬¬åå…«ç« ï¼šDDPG</a></li>
      <li><a href="#chapter19">ç¬¬åä¹ç« ï¼šTD3</a></li>
      <li><a href="#chapter20">ç¬¬äºŒåç« ï¼šTRPO</a></li>
      <li><a href="#chapter21">ç¬¬äºŒåä¸€ç« ï¼šPPO</a></li>
      <li><a href="#chapter22">ç¬¬äºŒåäºŒç« ï¼šSAC</a></li>
      <li><a href="#chapter23">ç¬¬äºŒåä¸‰ç« ï¼šç­–ç•¥æ¢¯åº¦å¢å¼ºç»„åˆ</a></li>
      <li><a href="#chapter_summary">è¿›é˜¶æ€»ç»“</a></li>
    </ul>
  </aside>

  <main>
  <section id="chapter14" class="chapter">
    <h2>ç¬¬åå››ç« ï¼šDueling DQNï¼ˆåŒæµæ¶æ„ï¼‰</h2>
    <p>Dueling DQN å°† Q ç½‘ç»œæ‹†åˆ†ä¸º<strong>çŠ¶æ€ä»·å€¼åˆ†æ”¯ V(s)</strong>ä¸<strong>åŠ¨ä½œä¼˜åŠ¿åˆ†æ”¯ A(s,a)</strong>ï¼Œç”¨ä¸¤æ¡å¹¶è¡Œçš„å­ç½‘ç»œåˆ†åˆ«ä¼°è®¡çŠ¶æ€çš„æ•´ä½“ä»·å€¼ä¸åŠ¨ä½œçš„ç›¸å¯¹ä¼˜åŠ¿ï¼Œå†å°†äºŒè€…ç»„åˆå¾—åˆ° Q å€¼ã€‚è¿™ç§è®¾è®¡åœ¨ä¸€äº›çŠ¶æ€ä¸‹åŠ¨ä½œå·®å¼‚è¾ƒå°ï¼ˆæˆ–åŠ¨ä½œæ— å…³ï¼‰çš„åœºæ™¯ä¸‹èƒ½æ˜¾è‘—æå‡ä¼°è®¡ç¨³å®šæ€§ä¸æ”¶æ•›é€Ÿåº¦ã€‚</p>

    <h3>1. æ ¸å¿ƒç»“æ„ä¸æ•°å­¦å½¢å¼</h3>
    <p>ä¸»å¹²ç½‘ç»œï¼ˆå·ç§¯æˆ–å‰é¦ˆï¼‰æå–å…±äº«ç‰¹å¾ååˆ†ä¸ºä¸¤æ¡åˆ†æ”¯ï¼š</p>
    <ul>
    <li><strong>Value Streamï¼š</strong>è¾“å‡ºæ ‡é‡ $V(s)$ï¼Œè¡¨ç¤ºçŠ¶æ€æœ¬èº«çš„ä»·å€¼ï¼›</li>
    <li><strong>Advantage Streamï¼š</strong>è¾“å‡ºå‘é‡ $A(s,a)$ï¼Œè¡¨ç¤ºåœ¨çŠ¶æ€ $s$ ä¸‹å„åŠ¨ä½œçš„ç›¸å¯¹ä¼˜åŠ¿ã€‚</li>
    </ul>
    <p>ä¸ºä½¿åˆ†è§£å¯è¾¨è¯†ï¼ˆidentifiableï¼‰ï¼Œé€šå¸¸ç”¨ä¸‹å¼é‡ç»„ Q å€¼ï¼š</p>
    <p>$$
    Q(s, a) = V(s) + \Big(A(s, a) - \frac{1}{|\mathcal{A}|} \sum_{a'} A(s, a')\Big)
    $$</p>
    <p>å‡å»ä¼˜åŠ¿å‡å€¼èƒ½ä¿è¯ $\sum_a A(s,a)=0$ï¼Œä»è€Œé¿å…ä»»æ„å¸¸æ•°åœ¨ V ä¸ A ä¹‹é—´è½¬ç§»å¯¼è‡´çš„ä¸å¯è¾¨è¯†é—®é¢˜ï¼ˆè§ä¸‹é¢çš„å”¯ä¸€åˆ†è§£è¯æ˜ï¼‰ã€‚</p>

    <h3>2. ç›´è§‰ä¸ä¼˜ç‚¹</h3>
    <ul>
    <li>å½“æŸäº›çŠ¶æ€ä¸‹ä¸åŒåŠ¨ä½œæ”¶ç›Šæ¥è¿‘æ—¶ï¼Œä¸“é—¨å­¦ä¹  $V(s)$ ä¼šæ›´ç¨³å®šï¼›</li>
    <li>$A(s,a)$ èšç„¦åŠ¨ä½œé—´å·®å¼‚ï¼Œèƒ½æ›´å¿«æ•æ‰å¾®å°ç­–ç•¥ä¼˜åŠ¿ï¼›</li>
    <li>å¯ä¸ Double DQNã€PERã€NoisyNet ç­‰æ”¹è¿›æ–¹æ³•ç›´æ¥ç»“åˆï¼Œå¸¸è§äºå¼ºåŒ–å­¦ä¹ ç«æŠ€å¹³å°ï¼ˆAtariã€ProcGen ç­‰ï¼‰ã€‚</li>
    </ul>

    <h3>3. å”¯ä¸€åˆ†è§£ï¼ˆIdentifiabilityï¼‰è¯æ˜</h3>
    <p>é—®é¢˜ï¼šç»™å®š Q(s,a)ï¼Œå°†å…¶å†™æˆ $Q(s,a)=V(s)+A(s,a)$ æ˜¯å¦å”¯ä¸€ï¼Ÿç­”æ¡ˆï¼šåœ¨æ²¡æœ‰çº¦æŸæ—¶ä¸æ˜¯å”¯ä¸€çš„ï¼›è‹¥å¯¹æ¯ä¸ª s æ–½åŠ çº¦æŸ $\sum_a A(s,a)=0$ï¼ˆæˆ–ç­‰ä»·çš„å¸¸æ•°çº¦æŸï¼‰ï¼Œåˆ™åˆ†è§£å”¯ä¸€ã€‚</p>
    <p>è¯æ˜ï¼š</p>
    <p>å‡è®¾å­˜åœ¨ä¸¤ç»„åˆ†è§£ $(V, A)$ ä¸ $(V', A')$ æ»¡è¶³å¯¹æ‰€æœ‰ $(s,a)$ï¼š</p>
    <p>$$Q(s,a)=V(s)+A(s,a)=V'(s)+A'(s,a).$$</p>
    <p>ä»¤ $D(s)=V(s)-V'(s)$ï¼Œ$E(s,a)=A(s,a)-A'(s,a)$ï¼Œåˆ™å¯¹æ‰€æœ‰ $(s,a)$ æœ‰</p>
    <p>$$D(s)+E(s,a)=0 \quad \Rightarrow \quad E(s,a) = -D(s).$$</p>
    <p>å¯¹åŠ¨ä½œé›†åˆæ±‚å’Œå¹¶ä½¿ç”¨çº¦æŸ $\sum_a E(s,a)=0$ï¼š</p>
    <p>$$\sum_a E(s,a) = -\sum_a D(s) = -|\mathcal{A}|\, D(s) = 0 \Rightarrow D(s)=0.$$</p>
    <p>äºæ˜¯ $D(s)=0$ï¼Œè¿›è€Œ $E(s,a)=0$ï¼Œå³ $(V,A)$ ä¸ $(V',A')$ åœ¨æ–½åŠ å‡å€¼çº¦æŸä¸‹ç›¸åŒï¼Œåˆ†è§£å”¯ä¸€ã€‚</p>

    <h3>4. æ ‡å‡†åŒ–ä¼ªä»£ç ï¼ˆå­¦æœ¯é£æ ¼ï¼‰</h3>
    <div style="background: rgba(156, 39, 176, 0.08); border-left: 4px solid #9c27b0; padding: 20px; margin: 20px 0; border-radius: 8px; font-family: 'Courier New', monospace; font-size: 14px; line-height: 1.6;">
    <h4 style="color: #9c27b0; margin-bottom: 12px; font-size: 16px;">ğŸ“‹ Dueling DQNï¼ˆåŒæµ DQNï¼‰ â€” ä¼ªä»£ç </h4>
    <div style="background: rgba(255,255,255,0.06); padding: 12px; border-radius: 6px; border: 1px solid rgba(255,255,255,0.08);">
      <pre style="margin:0; font-family: 'Courier New', monospace; font-size:13px; color:#e8f4fd; line-height:1.6;">
<span style="color:#bb86fc; font-weight:bold;">ç®—æ³•åç§°ï¼š</span>Dueling Deep Q-Network (Dueling DQN)
<span style="color:#bb86fc; font-weight:bold;">è¾“å…¥å‚æ•°ï¼š</span>
  â€¢ ç¯å¢ƒ â„° = âŸ¨ğ’®,ğ’œ,ğ’«,â„›âŸ©, ä¸»ç½‘ç»œå‚æ•° Î¸ï¼ˆè¾“å‡º V(s) ä¸ A(s,Â·)ï¼‰
  â€¢ ç›®æ ‡ç½‘ç»œå‚æ•° Î¸â», ç»éªŒå›æ”¾æ±  ğ’Ÿ, å­¦ä¹ ç‡ Î±, æŠ˜æ‰£ Î³
  â€¢ æ‰¹å¤§å° B, ç›®æ ‡æ›´æ–°é¢‘ç‡ C, è®­ç»ƒé¢‘ç‡ f
<span style="color:#bb86fc; font-weight:bold;">è¾“å‡ºï¼š</span>è®­ç»ƒå¥½çš„ä¸»ç½‘ç»œå‚æ•° Î¸*

<span style="color:#ff6b6b; font-weight:bold;">BEGIN</span>
<span style="color:#4ecdc4; font-weight:bold;">1.</span> <span style="color:#81c784; font-weight:bold;">åˆå§‹åŒ–</span>
  Î¸ â† random_init();  Î¸â» â† Î¸;  ğ’Ÿ â† âˆ…

<span style="color:#4ecdc4; font-weight:bold;">2.</span> <span style="color:#81c784; font-weight:bold;">FOR</span> episode = 1..MaxEpisodes <span style="color:#81c784; font-weight:bold;">DO</span>
  s â† env.reset()
    
  <span style="color:#4ecdc4; font-weight:bold;">3.</span> <span style="color:#81c784; font-weight:bold;">FOR</span> t = 1..MaxSteps <span style="color:#81c784; font-weight:bold;">DO</span>
    a â† Îµ-greedy( argmax_a Q(s,a;Î¸) )  âŠ³ Q ç”± V,A é‡ç»„å¾—åˆ°
    (r, s', done) â† env.step(a)
    ğ’Ÿ.store((s,a,r,s',done))

    <span style="color:#81c784; font-weight:bold;">IF</span> |ğ’Ÿ| â‰¥ B <span style="color:#81c784; font-weight:bold;">AND</span> t mod f = 0 <span style="color:#81c784; font-weight:bold;">THEN</span>
      batch â† ğ’Ÿ.sample(B)
      <span style="color:#81c784; font-weight:bold;">FOR</span> each (s_i,a_i,r_i,s'_i,done_i) in batch <span style="color:#81c784; font-weight:bold;">DO</span>
        <span style="color:#81c784; font-weight:bold;">IF</span> done_i <span style="color:#81c784; font-weight:bold;">THEN</span>
          y_i â† r_i
        <span style="color:#81c784; font-weight:bold;">ELSE</span>
          âŠ³ ä½¿ç”¨ç›®æ ‡ç½‘ç»œä¼°è®¡ Q'(s',Â·)
          V', A' â† network_forward(s'_i; Î¸â»)
          A'_norm â† A' - mean(A')  âŠ³ ä¿è¯ä¼˜åŠ¿å‡å€¼ä¸º 0
          Q'_vals â† V' + A'_norm
          y_i â† r_i + Î³Â·max_{a'} Q'_vals[a']
        <span style="color:#81c784; font-weight:bold;">END IF</span>
      <span style="color:#81c784; font-weight:bold;">END FOR</span>

      âŠ³ è®¡ç®—æŸå¤±å¹¶æ›´æ–°ä¸»ç½‘ç»œ Î¸ï¼ˆç»å…¸ MSE æˆ– Huberï¼‰
      L â† (1/B) âˆ‘ (y_i - Q(s_i,a_i;Î¸))Â²
      Î¸ â† Î¸ - Î±Â·âˆ‡_Î¸ L
    <span style="color:#81c784; font-weight:bold;">END IF</span>

    <span style="color:#81c784; font-weight:bold;">IF</span> t mod C = 0 <span style="color:#81c784; font-weight:bold;">THEN</span> Î¸â» â† Î¸
    s â† s'
    <span style="color:#81c784; font-weight:bold;">IF</span> done <span style="color:#81c784; font-weight:bold;">THEN</span> <span style="color:#81c784; font-weight:bold;">BREAK</span>
  <span style="color:#4ecdc4; font-weight:bold;">4.</span> <span style="color:#81c784; font-weight:bold;">END FOR</span>
<span style="color:#4ecdc4; font-weight:bold;">5.</span> <span style="color:#81c784; font-weight:bold;">END FOR</span>

<span style="color:#81c784; font-weight:bold;">RETURN</span> Î¸
<span style="color:#ff6b6b; font-weight:bold;">END</span>

<span style="color:#ffa726; font-weight:bold;">æ—¶é—´å¤æ‚åº¦ï¼š</span>O(Episodes Ã— Steps Ã— B Ã— Network_Forward)
<span style="color:#ffa726; font-weight:bold;">ç©ºé—´å¤æ‚åº¦ï¼š</span>O(N + |Î¸|)ï¼Œå¯é€‰åŒç½‘ç»œ(Î¸, Î¸â»)
<span style="color:#ffa726; font-weight:bold;">å…³é”®æŠ€æœ¯ï¼š</span>Value/Advantage åˆ†æ”¯ + ä¼˜åŒ–çš„é‡æ„ç­–ç•¥ï¼ˆå‡å€¼å½’ä¸€ï¼‰
      </pre>
    </div>

    <h3>5. PyTorch ä»£ç ç¤ºä¾‹ï¼ˆéª¨æ¶ï¼‰</h3>
    <pre class="language-python line-numbers"><code>import torch
import torch.nn as nn

class DuelingNetwork(nn.Module):
  def __init__(self, state_dim, action_dim):
    super().__init__()
    self.shared = nn.Sequential(
      nn.Linear(state_dim, 256),
      nn.ReLU(),
      nn.Linear(256, 256),
      nn.ReLU(),
    )
    self.value_stream = nn.Sequential(
      nn.Linear(256, 128),
      nn.ReLU(),
      nn.Linear(128, 1),
    )
    self.advantage_stream = nn.Sequential(
      nn.Linear(256, 128),
      nn.ReLU(),
      nn.Linear(128, action_dim),
    )

  def forward(self, x):
    feat = self.shared(x)
    value = self.value_stream(feat)
    advantage = self.advantage_stream(feat)
    advantage = advantage - advantage.mean(dim=1, keepdim=True)
    return value + advantage</code></pre>

    <h3>6. å®è·µè¦ç‚¹ä¸ç»„åˆç­–ç•¥</h3>
    <ul>
    <li>å¸¸ä¸ Double DQN çš„ç›®æ ‡è®¡ç®—ç»“åˆï¼Œä½¿ç”¨ä¸»ç½‘ç»œé€‰æ‹©åŠ¨ä½œã€ç›®æ ‡ç½‘ç»œè¯„ä¼°ä»·å€¼ï¼›</li>
    <li>ä¸ PERï¼ˆPrioritized Experience Replayï¼‰é…åˆèƒ½æ›´å¿«èšç„¦é«˜ TD è¯¯å·®æ ·æœ¬ï¼›</li>
    <li>åœ¨ç¦»æ•£åŠ¨ä½œé—®é¢˜ä¸Šè¡¨ç°ä¼˜å¼‚ï¼›åœ¨è¿ç»­åŠ¨ä½œç©ºé—´éœ€ä¸ç¡®å®šæ€§ç­–ç•¥ï¼ˆå¦‚ DDPGï¼‰æˆ–ç­–ç•¥åˆ†æ”¯é…åˆæ”¹é€ ï¼›</li>
    <li>è°ƒå‚è¦ç‚¹ï¼šé¿å…ä¼˜åŠ¿åˆ†æ”¯è¾“å‡ºè¿‡å¤§å¯¼è‡´æ•°å€¼ä¸ç¨³ï¼ˆå¯åŠ å½’ä¸€æˆ– L2 æ­£åˆ™ï¼‰ã€‚</li>
    </ul>
  </section>

    <section id="chapter15" class="chapter">
      <h2>ç¬¬åäº”ç« ï¼šPrioritized Experience Replayï¼ˆPERï¼‰</h2>
      <p>å ä½ï¼šæœ¬ç« èŠ‚å†…å®¹å¾…è¡¥å……ï¼ˆç®€è¦ä¿ç•™æ ‡é¢˜ä»¥ä¿æŒç›®å½•ç»“æ„ï¼‰ã€‚</p>
    </section>

    <section id="chapter16" class="chapter">
      <h2>ç¬¬åå…­ç« ï¼šNoisyNet DQN</h2>
      <p>å ä½ï¼šæœ¬ç« èŠ‚å†…å®¹å¾…è¡¥å……ï¼ˆç®€è¦ä¿ç•™æ ‡é¢˜ä»¥ä¿æŒç›®å½•ç»“æ„ï¼‰ã€‚</p>
    </section>

    <section id="chapter17" class="chapter">
      <h2>ç¬¬åä¸ƒç« ï¼šRainbow DQN</h2>
      <p>å ä½ï¼šæœ¬ç« èŠ‚å†…å®¹å¾…è¡¥å……ï¼ˆç®€è¦ä¿ç•™æ ‡é¢˜ä»¥ä¿æŒç›®å½•ç»“æ„ï¼‰ã€‚</p>
    </section>

    <section id="chapter18" class="chapter">
      <h2>ç¬¬åå…«ç« ï¼šDDPGï¼ˆDeep Deterministic Policy Gradientï¼‰</h2>
      <p>å ä½ï¼šæœ¬ç« èŠ‚å†…å®¹å¾…è¡¥å……ï¼ˆç®€è¦ä¿ç•™æ ‡é¢˜ä»¥ä¿æŒç›®å½•ç»“æ„ï¼‰ã€‚</p>
    </section>

    <section id="chapter19" class="chapter">
      <h2>ç¬¬åä¹ç« ï¼šTD3ï¼ˆTwin Delayed DDPGï¼‰</h2>
      <p>å ä½ï¼šæœ¬ç« èŠ‚å†…å®¹å¾…è¡¥å……ï¼ˆç®€è¦ä¿ç•™æ ‡é¢˜ä»¥ä¿æŒç›®å½•ç»“æ„ï¼‰ã€‚</p>
    </section>

    <section id="chapter20" class="chapter">
      <h2>ç¬¬äºŒåç« ï¼šTRPOï¼ˆTrust Region Policy Optimizationï¼‰</h2>
      <p>å ä½ï¼šæœ¬ç« èŠ‚å†…å®¹å¾…è¡¥å……ï¼ˆç®€è¦ä¿ç•™æ ‡é¢˜ä»¥ä¿æŒç›®å½•ç»“æ„ï¼‰ã€‚</p>
    </section>

    <section id="chapter21" class="chapter">
      <h2>ç¬¬äºŒåä¸€ç« ï¼šPPOï¼ˆProximal Policy Optimizationï¼‰</h2>
      <p>å ä½ï¼šæœ¬ç« èŠ‚å†…å®¹å¾…è¡¥å……ï¼ˆç®€è¦ä¿ç•™æ ‡é¢˜ä»¥ä¿æŒç›®å½•ç»“æ„ï¼‰ã€‚</p>
    </section>

    <section id="chapter22" class="chapter">
      <h2>ç¬¬äºŒåäºŒç« ï¼šSACï¼ˆSoft Actor-Criticï¼‰</h2>
      <p>å ä½ï¼šæœ¬ç« èŠ‚å†…å®¹å¾…è¡¥å……ï¼ˆç®€è¦ä¿ç•™æ ‡é¢˜ä»¥ä¿æŒç›®å½•ç»“æ„ï¼‰ã€‚</p>
    </section>

    <section id="chapter23" class="chapter">
      <h2>ç¬¬äºŒåä¸‰ç« ï¼šç­–ç•¥æ¢¯åº¦å¢å¼ºç»„åˆ</h2>
      <p>å ä½ï¼šæœ¬ç« èŠ‚å†…å®¹å¾…è¡¥å……ï¼ˆç®€è¦ä¿ç•™æ ‡é¢˜ä»¥ä¿æŒç›®å½•ç»“æ„ï¼‰ã€‚</p>
    </section>

    <section id="chapter_summary" class="chapter">
      <h2>è¿›é˜¶æ€»ç»“ä¸å­¦ä¹ å»ºè®®</h2>
      <h3>1. èƒ½åŠ›åœ°å›¾</h3>
      <table>
        <tr><th>èƒ½åŠ›</th><th>ç›¸å…³ç®—æ³•</th><th>æå‡è·¯å¾„</th></tr>
        <tr><td>æ ·æœ¬æ•ˆç‡</td><td>PERã€Rainbowã€SAC</td><td>ä¼˜å…ˆé‡‡æ · â†’ å¤šæ­¥ç›®æ ‡ â†’ æœ€å¤§ç†µ</td></tr>
        <tr><td>ç¨³å®šæ€§</td><td>Duelingã€TD3ã€PPO</td><td>æ¶æ„æ”¹è¿› â†’ åŒç½‘ç»œ â†’ å‰ªåˆ‡æŸå¤±</td></tr>
        <tr><td>è¿ç»­æ§åˆ¶</td><td>DDPGã€TD3ã€SAC</td><td>ç¡®å®šæ€§ç­–ç•¥ â†’ åŒ Critic â†’ æ¸©åº¦è‡ªé€‚åº”</td></tr>
      </table>

      <h3>2. å®æˆ˜è·¯çº¿</h3>
      <ol>
        <li>å…ˆåœ¨ <code>MuJoCo</code> ç­‰ç»å…¸ç¯å¢ƒå¤ç° PPO/SACï¼›</li>
        <li>å¼•å…¥ TD3 æˆ– Rainbow å¯¹æ¯”æŒ‡æ ‡ï¼›</li>
        <li>åœ¨è‡ªå®šä¹‰ç¯å¢ƒä¸­è°ƒå‚ï¼Œè§‚å¯Ÿå™ªå£°ã€ç†µç›®æ ‡ã€å­¦ä¹ ç‡å½±å“ã€‚</li>
      </ol>

      <h3>3. æ¨èé˜…è¯»</h3>
      <ul>
        <li>"Rainbow: Combining Improvements in Deep Reinforcement Learning"</li>
        <li>"Continuous Control with Deep Reinforcement Learning" (DDPG)</li>
        <li>"Addressing Function Approximation Error in Actor-Critic Methods" (TD3)</li>
        <li>"Proximal Policy Optimization Algorithms" (PPO)</li>
        <li>"Soft Actor-Critic" ç³»åˆ—è®ºæ–‡</li>
      </ul>
    </section>
  </main>
</div>

<footer>
  <p>Â© 2025 <span>Haoyun Tang</span> | Reinforcement Learning Advanced Notes</p>
</footer>

<script>
document.addEventListener('DOMContentLoaded', () => {
  document.querySelectorAll('pre[class*="language-"]').forEach(pre => {
    if (!pre.classList.contains('line-numbers')) {
      pre.classList.add('line-numbers');
    }
  });
  if (window.Prism) {
    Prism.highlightAll();
  }
});

window.addEventListener('load', () => {
  if (window.Prism) {
    Prism.highlightAll();
  }
});

const navLinks = document.querySelectorAll('nav a');
const asideLinks = document.querySelectorAll('aside a');
const combined = [...navLinks, ...asideLinks];

window.addEventListener('scroll', () => {
  const offset = window.scrollY + 160;
  combined.forEach(link => {
    const section = document.querySelector(link.getAttribute('href'));
    if (!section) return;
    if (section.offsetTop <= offset && section.offsetTop + section.offsetHeight > offset) {
      link.classList.add('active');
    } else {
      link.classList.remove('active');
    }
  });
});
</script>
</body>
</html>